<Window x:Class="paint.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Vector Paint Editor" Height="700" Width="1000" Background="#FFEEEEEE"
        Loaded="Window_Loaded"
        SizeChanged="Window_SizeChanged">

    <DockPanel>
        <!-- Меню -->
        <Menu DockPanel.Dock="Top" Background="#FFEEEEEE">
            <MenuItem Header="Файл">
                <MenuItem Header="Новый" Command="New" InputGestureText="Ctrl+N"/>
                <MenuItem Header="Открыть..." Command="Open" InputGestureText="Ctrl+O"/>
                <MenuItem Header="Сохранить" Command="Save" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Сохранить как..." Command="SaveAs"/>
                <Separator/>
                <MenuItem Header="Экспорт в SVG..." Click="ExportToSvg_Click"/>
                <Separator/>
                <MenuItem Header="Выход" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="Правка">
                <MenuItem Header="Отменить" Command="Undo" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="Повторить" Command="Redo" InputGestureText="Ctrl+Y"/>
            </MenuItem>
        </Menu>

        <!-- Упрощенная адаптивная панель инструментов -->
        <ScrollViewer DockPanel.Dock="Top" 
                      Height="45" 
                      VerticalScrollBarVisibility="Disabled"
                      HorizontalScrollBarVisibility="Auto"
                      Background="#EFEFEF"
                      Name="ToolbarScrollViewer">

            <StackPanel Orientation="Horizontal" Name="ToolbarPanel">

                <!-- Группа фигур -->
                <Border BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Фигура:" VerticalAlignment="Center" Margin="5,0,4,0"/>
                        <ComboBox Name="ShapeBox" Width="130" Margin="4" SelectedIndex="0"
                                 SelectionChanged="ShapeBox_SelectionChanged">
                            <ComboBoxItem Content="Линия" Tag="Line"/>
                            <ComboBoxItem Content="Прямоугольник" Tag="Rectangle"/>
                            <ComboBoxItem Content="Квадрат" Tag="Square"/>
                            <ComboBoxItem Content="Эллипс" Tag="Ellipse"/>
                            <ComboBoxItem Content="Окружность" Tag="Circle"/>
                            <ComboBoxItem Content="Многоугольник" Tag="Polygon"/>
                        </ComboBox>
                    </StackPanel>
                </Border>

                <!-- Группа цветов -->
                <Border BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Контур:" VerticalAlignment="Center" Margin="5,0"/>
                        <ComboBox Name="StrokeColorBox" Width="100" Margin="4" SelectedIndex="0" 
                                 SelectionChanged="StrokeColorBox_SelectionChanged">
                            <ComboBoxItem Content="Черный" Tag="Black"/>
                            <ComboBoxItem Content="Красный" Tag="Red"/>
                            <ComboBoxItem Content="Зелёный" Tag="Green"/>
                            <ComboBoxItem Content="Синий" Tag="Blue"/>
                            <ComboBoxItem Content="Жёлтый" Tag="Yellow"/>
                            <ComboBoxItem Content="Фиолетовый" Tag="Purple"/>
                        </ComboBox>
                    </StackPanel>
                </Border>

                <Border BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Заливка:" VerticalAlignment="Center" Margin="5,0"/>
                        <ComboBox Name="FillColorBox" Width="100" Margin="4" SelectedIndex="1" 
                                 SelectionChanged="FillColorBox_SelectionChanged">
                            <ComboBoxItem Content="Нет" Tag="Transparent"/>
                            <ComboBoxItem Content="Красный" Tag="Red"/>
                            <ComboBoxItem Content="Зелёный" Tag="Green"/>
                            <ComboBoxItem Content="Синий" Tag="Blue"/>
                            <ComboBoxItem Content="Жёлтый" Tag="Yellow"/>
                            <ComboBoxItem Content="Фиолетовый" Tag="Purple"/>
                            <ComboBoxItem Content="Черный" Tag="Black"/>
                        </ComboBox>
                    </StackPanel>
                </Border>

                <!-- Группа масштабирования -->
                <Border BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="-" Click="ZoomOutButton_Click" 
                                Margin="4,0,0,0" Padding="8,2" Width="30"
                                ToolTip="Уменьшить масштаб"/>
                        <TextBlock Name="ZoomTextBlock" Text="100%" 
                                  VerticalAlignment="Center" Margin="8,0" 
                                  Width="40" TextAlignment="Center"/>
                        <Button Content="+" Click="ZoomInButton_Click" 
                                Margin="0,0,4,0" Padding="8,2" Width="30"
                                ToolTip="Увеличить масштаб"/>
                        <Button Content="100%" Click="ZoomResetButton_Click" 
                                Margin="4,0" Padding="6,2" Width="45"
                                ToolTip="Сбросить масштаб"/>
                    </StackPanel>
                </Border>

                <!-- Группа редактирования -->
                <Border BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="✏️ Редакт." Name="EditModeButton"
                                Click="EditModeButton_Click" 
                                Margin="4,4" Padding="6,2" MinWidth="80"
                                Background="LightGreen"
                                ToolTip="Переключиться в режим редактирования"/>
                        <Button Content="🗑️ Удалить" 
                                Click="DeleteButton_Click" 
                                Margin="4,4" Padding="6,2" MinWidth="80"
                                Background="#FFFFE0E0"
                                ToolTip="Удалить выделенную фигуру"/>
                    </StackPanel>
                </Border>

                <!-- Группа очистки -->
                <Border Margin="5,0">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="🧹 Очистить" Click="ClearButton_Click" 
                                Margin="4,4" Padding="6,2" MinWidth="80"
                                Background="#FFE0E0FF"
                                ToolTip="Очистить весь холст"/>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Статусная строка -->
        <StatusBar DockPanel.Dock="Bottom" Height="25" Background="#FFDDDDDD">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Режим рисования"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Name="CoordinatesText" Text="X: 0, Y: 0"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Основной холст -->
        <ScrollViewer Name="MainScrollViewer" 
                     HorizontalScrollBarVisibility="Auto" 
                     VerticalScrollBarVisibility="Auto"
                     PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">

            <Canvas Name="DrawCanvas"
                    Width="2000"
                    Height="2000"
                    MouseDown="Canvas_MouseDown"
                    MouseMove="Canvas_MouseMove"
                    MouseUp="Canvas_MouseUp">

                <!-- Сетчатый фон -->
                <Canvas.Resources>
                    <DrawingBrush x:Key="GridPattern" TileMode="Tile" Viewport="0,0,50,50" ViewportUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <DrawingGroup>
                                <GeometryDrawing Brush="White">
                                    <GeometryDrawing.Geometry>
                                        <RectangleGeometry Rect="0,0,50,50"/>
                                    </GeometryDrawing.Geometry>
                                </GeometryDrawing>
                                <GeometryDrawing Brush="LightGray">
                                    <GeometryDrawing.Pen>
                                        <Pen Brush="LightGray" Thickness="1"/>
                                    </GeometryDrawing.Pen>
                                </GeometryDrawing>
                            </DrawingGroup>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Canvas.Resources>

                <Canvas.Background>
                    <StaticResource ResourceKey="GridPattern"/>
                </Canvas.Background>

            </Canvas>
        </ScrollViewer>

    </DockPanel>

    <!-- Горячие клавиши -->
    <Window.InputBindings>
        <KeyBinding Key="N" Modifiers="Ctrl" Command="New"/>
        <KeyBinding Key="O" Modifiers="Ctrl" Command="Open"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="Save"/>
        <KeyBinding Key="Z" Modifiers="Ctrl" Command="ApplicationCommands.Undo"/>
        <KeyBinding Key="Y" Modifiers="Ctrl" Command="ApplicationCommands.Redo"/>
    </Window.InputBindings>
</Window>